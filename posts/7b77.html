<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="信号模型 考虑一般的接收信号模型： y&#x3D;Xh+z\mathbf{y} &#x3D; \mathbf{X}\mathbf{h} + \mathbf{z}\\ y&#x3D;Xh+z 其中 \mathbf{y} \in \mathbb{C}^{N\times 1} 为接收信号矢量， \mathbf{h} \in \mathbb{C}^{M\times 1} 为信道矢量， \mathbf{X} \in \mathbb{C">
<meta property="og:type" content="article">
<meta property="og:title" content="LS 和 MMSE 估计">
<meta property="og:url" content="https://coisini2133.github.io/posts/7b77.html">
<meta property="og:site_name" content="Minddiy">
<meta property="og:description" content="信号模型 考虑一般的接收信号模型： y&#x3D;Xh+z\mathbf{y} &#x3D; \mathbf{X}\mathbf{h} + \mathbf{z}\\ y&#x3D;Xh+z 其中 \mathbf{y} \in \mathbb{C}^{N\times 1} 为接收信号矢量， \mathbf{h} \in \mathbb{C}^{M\times 1} 为信道矢量， \mathbf{X} \in \mathbb{C">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-04-11T04:34:14.000Z">
<meta property="article:modified_time" content="2024-04-13T08:54:51.257Z">
<meta property="article:author" content="Liwen">
<meta property="article:tag" content="技术">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="https://s2.loli.net/2024/03/10/ZLwMDWmugJqGTV6.jpg">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>LS 和 MMSE 估计</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.0.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     --><!--
       --><li><a href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="下一篇" href="/posts/7a66.html"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://coisini2133.github.io/posts/7b77.html"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://coisini2133.github.io/posts/7b77.html&text=LS 和 MMSE 估计"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://coisini2133.github.io/posts/7b77.html&title=LS 和 MMSE 估计"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://coisini2133.github.io/posts/7b77.html&is_video=false&description=LS 和 MMSE 估计"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=LS 和 MMSE 估计&body=Check out this article: https://coisini2133.github.io/posts/7b77.html"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://coisini2133.github.io/posts/7b77.html&title=LS 和 MMSE 估计"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://coisini2133.github.io/posts/7b77.html&title=LS 和 MMSE 估计"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://coisini2133.github.io/posts/7b77.html&title=LS 和 MMSE 估计"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://coisini2133.github.io/posts/7b77.html&title=LS 和 MMSE 估计"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://coisini2133.github.io/posts/7b77.html&name=LS 和 MMSE 估计&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://coisini2133.github.io/posts/7b77.html&t=LS 和 MMSE 估计"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E5%8F%B7%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.</span> <span class="toc-text"> 信号模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98ls%E4%BC%B0%E8%AE%A1"><span class="toc-number">2.</span> <span class="toc-text"> 最小二乘(LS)估计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E5%AF%BC%E6%B3%95"><span class="toc-number">2.1.</span> <span class="toc-text"> 求导法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E6%96%B9%E6%B3%95"><span class="toc-number">2.2.</span> <span class="toc-text"> 配方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%95%E5%BD%B1%E6%B3%95"><span class="toc-number">2.3.</span> <span class="toc-text"> 投影法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6ml%E4%BC%B0%E8%AE%A1%E7%9A%84%E7%AD%89%E4%BB%B7%E6%80%A7"><span class="toc-number">2.4.</span> <span class="toc-text"> 与最大似然（ML）估计的等价性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%B0%E8%AE%A1%E8%AF%AF%E5%B7%AE%E5%88%86%E6%9E%90"><span class="toc-number">2.5.</span> <span class="toc-text"> 估计误差分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E5%9D%87%E6%96%B9%E8%AF%AF%E5%B7%AEmmse%E4%BC%B0%E8%AE%A1"><span class="toc-number">3.</span> <span class="toc-text"> 最小均方误差（MMSE）估计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E5%AF%BC%E6%B3%95-2"><span class="toc-number">3.1.</span> <span class="toc-text"> 求导法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E6%96%B9%E6%B3%95-2"><span class="toc-number">3.2.</span> <span class="toc-text"> 配方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E4%BA%A4%E6%B3%95"><span class="toc-number">3.3.</span> <span class="toc-text"> 正交法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E%E6%9C%80%E5%A4%A7%E5%90%8E%E9%AA%8C%E6%A6%82%E7%8E%87map%E4%BC%B0%E8%AE%A1%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">3.4.</span> <span class="toc-text"> 与最大后验概率（MAP）估计的关系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">4.</span> <span class="toc-text"> 应用场景</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        LS 和 MMSE 估计
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Liwen</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-04-11T04:34:14.000Z" class="dt-published" itemprop="datePublished">2024-04-11</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="信号模型"><a class="markdownIt-Anchor" href="#信号模型"></a> 信号模型</h2>
<p>考虑一般的接收信号模型：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mi mathvariant="bold">X</mi><mi mathvariant="bold">h</mi><mo>+</mo><mi mathvariant="bold">z</mi><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\mathbf{y} = \mathbf{X}\mathbf{h} + \mathbf{z}\\
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mord"><span class="mord mathbf">h</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">z</span></span></span><span class="mspace newline"></span></span></span></span></p>
<p>其中 \mathbf{y} \in \mathbb{C}^{N\times 1} 为接收信号矢量， \mathbf{h} \in \mathbb{C}^{M\times 1} 为信道矢量， \mathbf{X} \in \mathbb{C}^{N\times M} 为发送信号矩阵（通常为导频矩阵）， \mathbf{z} \in \mathbb{C}^{N\times 1} 为噪声矢量，且 \mathbf{z}\sim \mathcal{CN}(\mathbf{0}, \sigma_{z}^{2}\mathbf{I}) 。</p>
<h2 id="最小二乘ls估计"><a class="markdownIt-Anchor" href="#最小二乘ls估计"></a> 最小二乘(LS)估计</h2>
<h3 id="求导法"><a class="markdownIt-Anchor" href="#求导法"></a> <strong>求导法</strong></h3>
<p>LS估计的原则是估计出使得 \mathbf{Xh} 与 \mathbf{y} “距离”最小的 \mathbf{h} ，即使以下代价函数最小：</p>
<p>\begin{align} J(\mathbf{h}) &amp;= |\mathbf{y}-\mathbf{X}\mathbf{h}|^{2} \nonumber\ &amp;=(\mathbf{y}-\mathbf{X}\mathbf{h})^{\mathrm{H}}(\mathbf{y}-\mathbf{X}\mathbf{h}) \ &amp;=\mathbf{y}<sup>{\mathrm{H}}\mathbf{y}-\mathbf{y}</sup>{\mathrm{H}}\mathbf{X}\mathbf{h}- \mathbf{h}<sup>{\mathrm{H}}\mathbf{X}</sup>{\mathrm{H}}\mathbf{y}+\mathbf{h}^{\mathrm{H}} \mathbf{X}^{\mathrm{H}}\mathbf{X}\mathbf{h} \nonumber \end{align}\</p>
<p>令上述代价函数关于 \mathbf{h} 的偏导为 0 ，即：</p>
<p>\begin{align} \frac{\partial J(\mathbf{h})}{\partial \mathbf{h}} = -2(\mathbf{X}<sup>{\mathrm{H}}\mathbf{y})</sup>{\ast} + 2(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{h})</sup>{\ast} = 0 \end{align}\</p>
<p>由此得到LS信道估计的解：</p>
<p>\hat{\mathbf{h}}_{\mathrm{LS}} = (\mathbf{X}<sup>{\mathrm{H}}\mathbf{X})</sup>{-1}\mathbf{X}^{\mathrm{H}}\mathbf{y}\</p>
<h3 id="配方法"><a class="markdownIt-Anchor" href="#配方法"></a> <strong>配方法</strong></h3>
<p>将代价函数配方可得：</p>
<p class='katex-block katex-error' title='ParseError: KaTeX parse error: No such environment: align at position 7: \begin{̲a̲l̲i̲g̲n̲}̲{ J(\mathbf{h})…'>\begin{align}{ J(\mathbf{h}) = \left(\mathbf{h} - \left(\mathbf{X}^{\mathrm{H}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{H}}\mathbf{y}\right)^{\mathrm{H}}\mathbf{X}^{\mathrm{H}}\mathbf{X} \left(\mathbf{h} - \left(\mathbf{X}^{\mathrm{H}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{H}}\mathbf{y}\right) + \mathbf{y}^{\mathrm{H}}\left(\mathbf{I} - \mathbf{X}\left(\mathbf{X}^{\mathrm{H}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{H}}\right)\mathbf{y} }\end{align}\\
</p>
<p>其中 \left(\mathbf{h} - \left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\right)</sup>{-1}\mathbf{X}<sup>{\mathrm{H}}\mathbf{y}\right)</sup>{\mathrm{H}}\mathbf{X}^{\mathrm{H}}\mathbf{X} \left(\mathbf{h} - \left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\right)</sup>{-1}\mathbf{X}^{\mathrm{H}}\mathbf{y}\right)\geq0 ，当且仅当 \mathbf{h} = (\mathbf{X}<sup>{\mathrm{H}}\mathbf{X})</sup>{-1}\mathbf{X}^{\mathrm{H}}\mathbf{y} 时取等且 J(\mathbf{h}) 取得最小值，即对应LS解。</p>
<h3 id="投影法"><a class="markdownIt-Anchor" href="#投影法"></a> <strong>投影法</strong></h3>
<p>LS估计可看作Hilbert空间中的线性逼近问题，可用投影法求解.。</p>
<p>要使 \mathbf{X}\hat{\mathbf{h}} 与 \mathbf{y} “距离”最小，即求 \mathbf{y} 在 \mathbf{X} 的列空间 \mathrm{R}(\mathbf{X}) 的投影，从而对 \forall \mathbf{x}\in \mathrm{R}(\mathbf{X}) 有：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi mathvariant="bold">y</mi><mo>−</mo><mi mathvariant="bold">X</mi><mover accent="true"><mi mathvariant="bold">h</mi><mo>^</mo></mover><mo separator="true">,</mo><mi mathvariant="bold">x</mi><mo>&gt;</mo><mo>=</mo><mn>0</mn><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">&lt;\mathbf{y} - \mathbf{X}\hat{\mathbf{h}}, \mathbf{x}&gt; = 0\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1523199999999998em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">h</span></span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">x</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span><span class="mspace newline"></span></span></span></p>
<p>即有 \mathbf{X}^{\mathrm{H}}(\mathbf{y} - \mathbf{X}\hat{\mathbf{h}}) = \mathbf{0} ，从而得到 \hat{\mathbf{h}}_{\mathrm{LS}} = (\mathbf{X}<sup>{\mathrm{H}}\mathbf{X})</sup>{-1}\mathbf{X}^{\mathrm{H}}\mathbf{y} 。</p>
<h3 id="与最大似然ml估计的等价性"><a class="markdownIt-Anchor" href="#与最大似然ml估计的等价性"></a> <strong>与最大似然（ML）估计的等价性</strong></h3>
<p>ML估计的原理是估计出使得似然函数 p(\mathbf{y}|\mathbf{h}) 最大的 \mathbf{h} ，即</p>
<p class='katex-block katex-error' title='ParseError: KaTeX parse error: No such environment: align at position 7: \begin{̲a̲l̲i̲g̲n̲}̲ \hat{\mathbf{h…'>\begin{align} \hat{\mathbf{h}}_{\mathrm{ML}} &amp;= \arg\max_{\mathbf{h}\in\mathbb{C}^{N}}p(\mathbf{y}|\mathbf{h})\nonumber\\ &amp;= \arg\max_{\mathbf{h}\in\mathbb{C}^{N}}\sigma_{z}^{-2}\pi^{-1}\exp\left(-\sigma_{z}^{-2}(\mathbf{y} - \mathbf{X}\mathbf{h})^{\mathrm{H}}(\mathbf{y} - \mathbf{X}\mathbf{h})\right)\nonumber\\ &amp;= \arg\min_{\mathbf{h}\in\mathbb{C}^{N}}(\mathbf{y} - \mathbf{X}\mathbf{h})^{\mathrm{H}}(\mathbf{y} - \mathbf{X}\mathbf{h})\nonumber\\ &amp;=\left(\mathbf{X}^{\mathrm{H}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{H}}\mathbf{y}\end{align}\\可见与LS估计等价。另外注意到两者的等价关系来自 \mathbf{z}\sim \mathcal{CN}(\mathbf{0}, \sigma_{z}^{2}\mathbf{I})
</p>
<h3 id="估计误差分析"><a class="markdownIt-Anchor" href="#估计误差分析"></a> <strong>估计误差分析</strong></h3>
<p>LS估计与真实值之间的均方误差为：</p>
<p class='katex-block katex-error' title='ParseError: KaTeX parse error: No such environment: align at position 7: \begin{̲a̲l̲i̲g̲n̲}̲ \varepsilon_{\…'>\begin{align} \varepsilon_{\mathrm{LS}} &amp;= \mathbb{E}\{\|\hat{\mathbf{h}}_{\mathrm{LS}} - \mathbf{h}\|^{2}\} \nonumber\\ &amp;= \mathbb{E}\{\|(\mathbf{X}^{\mathrm{H}}\mathbf{X})^{-1}\mathbf{X}^{\mathrm{H}} (\mathbf{X}\mathbf{h}+\mathbf{z})-\mathbf{h}\|^{2}\} \nonumber\\ &amp;= \mathbb{E}\{\|(\mathbf{X}^{\mathrm{H}}\mathbf{X})^{-1}\mathbf{X}^{\mathrm{H}}\mathbf{z}\|^{2}\}\nonumber\\ &amp;=\mathbb{E}\{\left((\mathbf{X}^{\mathrm{H}}\mathbf{X})^{-1}\mathbf{X}^{\mathrm{H}}\mathbf{z}\right)^{\mathrm{H}} (\mathbf{X}^{\mathrm{H}}\mathbf{X})^{-1}\mathbf{X}^{\mathrm{H}}\mathbf{z}\}\\ &amp;=\mathbb{E}\{\mathrm{tr}\left(\mathbf{z}^{\mathrm{H}}\mathbf{X}(\mathbf{X}^{\mathrm{H}}\mathbf{X})^{-2}\mathbf{X} ^{\mathrm{H}}\mathbf{z}\right)\}\nonumber\\ &amp;=\mathrm{tr}\left(\mathbf{X}^{\mathrm{H}}\mathbb{E}\{\mathbf{z}\mathbf{z}^{\mathrm{H}}\}\mathbf{X}(\mathbf{X}^{\mathrm{H}}\mathbf{X})^{-2}\right)\nonumber\\ &amp;=\mathrm{tr}\left(\sigma_{z}^{2}(\mathbf{X}^{\mathrm{H}}\mathbf{X})^{-1}\right) \nonumber \end{align}\\
</p>
<h2 id="最小均方误差mmse估计"><a class="markdownIt-Anchor" href="#最小均方误差mmse估计"></a> 最小均方误差（MMSE）估计</h2>
<h3 id="求导法-2"><a class="markdownIt-Anchor" href="#求导法-2"></a> <strong>求导法</strong></h3>
<p>MMSE估计为使得估计值与真实值均方误差最小的线性估计，即 \hat{\mathbf{h}}=\mathbf{C}\mathbf{y} ，使得以下代价函数最小：</p>
<p class='katex-block katex-error' title='ParseError: KaTeX parse error: No such environment: align at position 7: \begin{̲a̲l̲i̲g̲n̲}̲ J(\mathbf{C}) …'>\begin{align} J(\mathbf{C}) &amp;= \mathbb{E}\{\|\mathbf{e}\|^{2}\} = \mathbb{E}\{\|\mathbf{h}-\hat{\mathbf{h}}\|^{2}\}\\ &amp;= \mathbb{E}\{(\mathbf{h} - \mathbf{Cy})^{\mathrm{H}}(\mathbf{h} - \mathbf{Cy})\}\\ &amp;= \mathbb{E}\left\{\mathbf{h}^{\mathrm{H}}\mathbf{h} - \mathbf{h}^{\mathrm{H}}\mathbf{Cy}-\mathbf{y}^{\mathrm{H}}\mathbf{C}^{\mathrm{H}}\mathbf{h}+\mathbf{y}^{\mathrm{H}}\mathbf{C}^{\mathrm{H}}\mathbf{Cy}\right\}\\ &amp;= \mathbb{E}\left\{\mathrm{tr}\{\mathbf{h}^{\mathrm{H}}\mathbf{h}\} - \mathrm{tr}\{\mathbf{h}^{\mathrm{H}}\mathbf{Cy}\}-\mathrm{tr}\{\mathbf{y}^{\mathrm{H}}\mathbf{C}^{\mathrm{H}}\mathbf{h}\}+\mathrm{tr}\{\mathbf{y}^{\mathrm{H}}\mathbf{C}^{\mathrm{H}}\mathbf{Cy}\}\right\} \end{align}\\
</p>
<p>根据矩阵求导公式[1]有：</p>
<p class='katex-block katex-error' title='ParseError: KaTeX parse error: No such environment: align at position 7: \begin{̲a̲l̲i̲g̲n̲}̲ \frac{\partial…'>\begin{align} \frac{\partial \mathrm{tr}\{\mathbf{h}^{\mathrm{H}}\mathbf{h}\} }{\partial \mathbf{C}} &amp;= 0,\qquad \frac{\partial \mathrm{tr}\{\mathbf{h}^{\mathrm{H}}\mathbf{Cy}\}}{\partial \mathbf{C}} = \mathbf{h}^{\ast}\mathbf{y}^{\mathrm{T}},\\ \frac{\partial \mathrm{tr}\{\mathbf{y}^{\mathrm{H}}\mathbf{C}^{\mathrm{H}}\mathbf{h}\}}{\partial \mathbf{C}} &amp;= 0,\qquad \frac{\partial \mathrm{tr}\{\mathbf{y}^{\mathrm{H}}\mathbf{C}^{\mathrm{H}}\mathbf{Cy}\}}{\partial \mathbf{C}} = \frac{\partial \mathrm{tr}\{\mathbf{Cy}\mathbf{y}^{\mathrm{H}}\mathbf{C}^{\mathrm{H}}\}}{\partial \mathbf{C}} = \mathbf{C}^{\ast}\left(\mathbf{y}\mathbf{y}^{\mathrm{H}}\right)^{\mathrm{T}} \end{align}\\
</p>
<p>记 \mathbf{R_{y}} = \mathbb{E}{\mathbf{y}\mathbf{y}^{\mathrm{H}}} ， \mathbf{R_{h}} = \mathbb{E}{\mathbf{h}\mathbf{h}^{\mathrm{H}}} ，\mathbf{R_{hy}} = \mathbb{E}{\mathbf{h}\mathbf{y}^{\mathrm{H}}} ，注意到 \mathbf{R_{y}} 和 \mathbf{R_{h}} 均为Hermitian矩阵，则有：</p>
<p>\frac{\partial J(\mathbf{C})}{\partial \mathbf{C}} = -\mathbf{R}<em>\mathbf{hy}^{\ast} + \mathbf{C}<sup>{\ast}\mathbf{R_{y}}</sup>{\mathrm{T}} = -\mathbf{R}</em>\mathbf{hy}^{\ast} + \mathbf{C}<sup>{\ast}\mathbf{R}_{\mathbf{y}}</sup>{\ast}\</p>
<p>令以上偏导结果为0，可得MMSE线性变换矩阵：</p>
<p>\mathbf{C}<em>{\mathrm{MMSE}} = \mathbf{R}</em>{\mathbf{hy}}\mathbf{R}_{\mathbf{y}}^{-1}\</p>
<p>其中：</p>
<p>\begin{align} \mathbf{R}<em>{\mathbf{hy}} &amp;= \mathbb{E}{\mathbf{h}\mathbf{y}^{\mathrm{H}}} = \mathbb{E}{\mathbf{h}\left(\mathbf{X}\mathbf{h} + \mathbf{z}\right)^{\mathrm{H}}} \nonumber\ &amp;=\mathbb{E}{\mathbf{h}\mathbf{h}<sup>{\mathrm{H}}}\mathbf{X}</sup>{\mathrm{H}}+\mathbb{E}{\mathbf{h}\mathbf{z}^{\mathrm{H}}}\ &amp;=\mathbf{R</em>{h}}\mathbf{X}^{\mathrm{H}} \nonumber\ \mathbf{R}<em>{\mathbf{y}} &amp;= \mathbb{E}{\mathbf{y}\mathbf{y}^{\mathrm{H}}} = \mathbb{E}{\left(\mathbf{X}\mathbf{h} + \mathbf{z}\right)\left(\mathbf{X}\mathbf{h} + \mathbf{z}\right)^{\mathrm{H}}} \nonumber\ &amp;=\mathbb{E}{\mathbf{X}\mathbf{h}\mathbf{h}<sup>{\mathrm{H}}\mathbf{X}</sup>{\mathrm{H}}}+\mathbb{E}{\mathbf{z}\mathbf{z}^{\mathrm{H}}}\ &amp;=\mathbf{X}\mathbf{R}</em>{\mathbf{h}}\mathbf{X}<sup>{\mathrm{H}}+\sigma_{z}</sup>{2}\mathbf{I} \nonumber \end{align}\</p>
<p>由此可得MMSE信道估计的解：</p>
<p>\hat{\mathbf{h}}<em>{MMSE} = \mathbf{R}</em>{\mathbf{h}}\mathbf{X}<sup>{\mathrm{H}}\left(\mathbf{X}\mathbf{R}_{\mathbf{h}}\mathbf{X}</sup>{\mathrm{H}}+\sigma_{z}<sup>{2}\mathbf{I}\right)</sup>{-1}\mathbf{y}= \mathbf{R}_{\mathbf{h}}\left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}+\sigma_{z}</sup>{2}\mathbf{I}\right)<sup>{-1}\mathbf{X}</sup>{\mathrm{H}}\mathbf{y}\</p>
<p>关于上式第二个等号，推导过程如下：</p>
<p>\begin{align} &amp;\left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}+\sigma_{z}</sup>{2}\mathbf{I}\right)\mathbf{X}<sup>{\mathrm{H}}=\mathbf{X}</sup>{\mathrm{H}}\left(\mathbf{X}\mathbf{R}<em>{\mathbf{h}}\mathbf{X}<sup>{\mathrm{H}}+\sigma_{z}</sup>{2}\mathbf{I}\right)\ \Leftrightarrow &amp;\mathbf{X}<sup>{\mathrm{H}}\left(\mathbf{X}\mathbf{R}_{\mathbf{h}}\mathbf{X}</sup>{\mathrm{H}}+\sigma</em>{z}<sup>{2}\mathbf{I}\right)</sup>{-1}= \left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}+\sigma_{z}</sup>{2}\mathbf{I}\right)<sup>{-1}\mathbf{X}</sup>{\mathrm{H}} \ \Rightarrow&amp;\mathbf{R}<em>{\mathbf{h}}\mathbf{X}<sup>{\mathrm{H}}\left(\mathbf{X}\mathbf{R}_{\mathbf{h}}\mathbf{X}</sup>{\mathrm{H}}+\sigma</em>{z}<sup>{2}\mathbf{I}\right)</sup>{-1}\mathbf{y}= \mathbf{R}_{\mathbf{h}}\left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}+\sigma_{z}</sup>{2}\mathbf{I}\right)<sup>{-1}\mathbf{X}</sup>{\mathrm{H}}\mathbf{y}\end{align}\</p>
<p>另外补充 一点，可能有朋友会对矩阵 \left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}+\sigma_{z}</sup>{2}\mathbf{I}\right) 的可逆性产生疑问，注意到：</p>
<p>\begin{equation}{ \sigma_{\mathrm{z}}^{-2}\left(\mathbf{I} - \mathbf{X}<sup>{\mathrm{H}}\left(\mathbf{X}\mathbf{R}_{\mathbf{h}}\mathbf{X}</sup>{\mathrm{H}}+\sigma_{z}<sup>{2}\mathbf{I}\right)</sup>{-1}\mathbf{X}\mathbf{R}_{\mathbf{h}}\right)\left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}+\sigma_{z}</sup>{2}\mathbf{I}\right) = \mathbf{I} }\end{equation}\</p>
<p>因此 \left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}+\sigma_{z}</sup>{2}\mathbf{I}\right) 可逆。</p>
<h3 id="配方法-2"><a class="markdownIt-Anchor" href="#配方法-2"></a> <strong>配方法</strong></h3>
<p>将代价函数重写为：</p>
<p>\begin{align} J(\mathbf{C}) &amp;= \mathbb{E}{(\mathbf{h} - \mathbf{Cy})^{\mathrm{H}}(\mathbf{h} - \mathbf{Cy})}\ &amp;= \mathrm{tr} \left{\mathbb{E}{(\mathbf{h} - \mathbf{Cy})(\mathbf{h} - \mathbf{Cy})^{\mathrm{H}}}\right}\ &amp;= \mathrm{tr}\left{\mathbf{R}<em>{\mathbf{h}} - \mathbf{R}</em>{\mathbf{hy}}\mathbf{C}^{\mathrm{H}} - \mathbf{C}\mathbf{R}<em>{\mathbf{hy}}^{\mathrm{H}} + \mathbf{C}\mathbf{R}</em>{y}\mathbf{C}^{\mathrm{H}}\right}\ &amp;= \mathrm{tr}\left{\left(\mathbf{C} - \mathbf{R}<em>{\mathbf{hy}}\mathbf{R}</em>{\mathbf{y}}^{-1}\right)\mathbf{R}<em>{\mathbf{y}}\left(\mathbf{C} - \mathbf{R}</em>{\mathbf{hy}}\mathbf{R}<em>{\mathbf{y}}<sup>{-1}\right)</sup>{\mathrm{H}}\right} + \mathrm{tr}\left{\mathbf{R}</em>{\mathbf{h}} - \mathbf{R}<em>{\mathbf{hy}}\mathbf{R}</em>{\mathbf{y}}<sup>{-1}\mathbf{R}_{\mathbf{hy}}</sup>{\mathrm{H}}\right} \end{align}\</p>
<p>其中 \left(\mathbf{C} - \mathbf{R}<em>{\mathbf{hy}}\mathbf{R}</em>{\mathbf{y}}^{-1}\right)\mathbf{R}<em>{\mathbf{y}}\left(\mathbf{C} - \mathbf{R}</em>{\mathbf{hy}}\mathbf{R}<em>{\mathbf{y}}<sup>{-1}\right)</sup>{\mathrm{H}}半正定，即所有特征值非负，从而其迹为非负，当且仅当 \mathbf{C}= \mathbf{R}</em>{\mathbf{hy}}\mathbf{R}_{\mathbf{y}}^{-1} 时为0，此时 J(\mathbf{C}) 取最小值，即对应MMSE解。</p>
<h3 id="正交法"><a class="markdownIt-Anchor" href="#正交法"></a> <strong>正交法</strong></h3>
<p>类似LS估计的投影法，根据线性最小均方误差参数估计的正交原理可知 J(\mathbf{C}) 取得最小值的条件为数据向量与误差向量正交：</p>
<p>\mathbb{E}{\mathbf{e}\mathbf{y}^{\mathrm{H}}} = \mathbb{E}{(\mathbf{Cy}-\mathbf{h})\mathbf{y}^{\mathrm{H}}}=0\</p>
<p>从而直接得到：</p>
<p>\mathbf{C}<em>{\mathrm{MMSE}} = \mathbf{R}</em>{\mathbf{hy}}\mathbf{R}_{\mathbf{y}}^{-1}\</p>
<h3 id="与最大后验概率map估计的关系"><a class="markdownIt-Anchor" href="#与最大后验概率map估计的关系"></a> <strong>与最大后验概率（MAP）估计的关系</strong></h3>
<p>MAP是通常意义上最优的参数估计准则，其原理是估计出使得后验概率密度函数 p(\mathbf{h}|\mathbf{y}) 最大的 \mathbf{h} ，根据贝叶斯公式有</p>
<p>\hat{\mathbf{h}}_{\mathrm{MAP}} = \underset{\mathbf{h}\in\mathbb{C}^{M}}{\arg \max }\ p(\mathbf{h}|\mathbf{y}) = \underset{\mathbf{h}\in\mathbb{C}^{M}}{\arg \max}\frac{p(\mathbf{y}|\mathbf{h})p(\mathbf{h})}{\int p(\mathbf{y} |\mathbf{h})p(\mathbf{h})\mathrm{d}\mathbf{h}} \</p>
<p>考察\mathbf{h}先验服从零均值复高斯分布 \mathcal{CN}\left(\mathbf{0}, \mathbf{R}<em>{h}\right) 的情形，且协方差矩阵 \mathbf{R}</em>{h} 正定。此时</p>
<p>p(\mathbf{h}) = \mathrm{det}\left(\pi\mathbf{R}<em>{h}\right)<sup>{-1}\exp\left{-\mathbf{h}</sup>{\mathrm{H}}\mathbf{R}</em>{h}^{-1}\mathbf{h}\right}\p(\mathbf{y}|\mathbf{h}) = \sigma_{z}<sup>{-2}\pi</sup>{-1}\exp\left(-\sigma_{z}^{-2}(\mathbf{y} - \mathbf{X}\mathbf{h})^{\mathrm{H}}(\mathbf{y} - \mathbf{X}\mathbf{h})\right)\</p>
<p>从而</p>
<p>\begin{align} p(\mathbf{h}|\mathbf{y})&amp;\propto p(\mathbf{y}|\mathbf{h})p(\mathbf{h})\ &amp;\propto \exp\left{-\sigma_{\mathrm{z}}^{-2}\left(\mathbf{y} - \mathbf{Xh}\right)^{\mathrm{H}}\left(\mathbf{y} - \mathbf{Xh}\right) - \mathbf{h}^{\mathrm{H}}\mathbf{R}<em>{h}\mathbf{h}\right} \ &amp;\propto\exp\left{-\left(\mathbf{h} - \bm{\mu}</em>{\mathbf{h}|\mathbf{y}}\right)<sup>{\mathrm{H}}\mathbf{D}_{\mathbf{h}|\mathbf{y}}</sup>{-1}\left(\mathbf{h} - \bm{\mu}_{\mathbf{h}|\mathbf{y}}\right)\right}\end{align}\ 其中</p>
<p>\mathbf{D}<em>{\mathbf{h}|\mathbf{y}} = \sigma</em>{\mathrm{z}}<sup>{2}\left(\mathbf{X}</sup>{\mathrm{H}}\mathbf{X} + \sigma_{\mathrm{z}}<sup>{2}\mathbf{R}_{h}</sup>{-1}\right)^{-1}\</p>
<p>\bm{\mu}<em>{\mathbf{h}|\mathbf{y}} = \sigma</em>{\mathrm{z}}<sup>{-2}\mathbf{D}_{\mathbf{h}|\mathbf{y}}\mathbf{X}</sup>{\mathrm{H}}\mathbf{y}\ 于是 p(\mathbf{h}|\mathbf{y}) 服从复高斯分布，均值和方差分别为 \bm{\mu}<em>{\mathbf{h}|\mathbf{y}} 和 \mathbf{D}</em>{\mathbf{h}|\mathbf{y}} ，因此 \mathbf{h} = \bm{\mu}_{\mathbf{h}|\mathbf{y}} 时p(\mathbf{h}|\mathbf{y})有最大取值，从而</p>
<p>\hat{\mathbf{h}}<em>{\mathrm{MAP}} = \bm{\mu}</em>{\mathbf{h}|\mathbf{y}} = \left(\mathbf{X}^{\mathrm{H}}\mathbf{X} + \sigma_{\mathrm{z}}<sup>{2}\mathbf{R}_{h}</sup>{-1}\right)<sup>{-1}\mathbf{X}</sup>{\mathrm{H}}\mathbf{y} = \mathbf{R}<em>{\mathbf{h}}\left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}+\sigma_{z}</sup>{2}\mathbf{I}\right)<sup>{-1}\mathbf{X}</sup>{\mathrm{H}}\mathbf{y}\ 可见此时 \hat{\mathbf{h}}</em>{\mathrm{MAP}} =\hat{\mathbf{h}}_{\mathrm{MMSE}} ，即 \mathbf{h} 的后验均值。</p>
<p><strong>估计误差分析</strong></p>
<p>定义信道估计误差矢量：</p>
<p>\tilde{\mathbf{h}} = \mathbf{h} - \hat{\mathbf{h}}\</p>
<p>根据正交原理可知估计值与误差正交，即 \mathbb{E}{\tilde{\mathbf{h}}\hat{\mathbf{h}}^{\mathrm{H}}} = 0 ，由此可得MMSE估计与真实值之间的均方误差：</p>
<p>\begin{align} \varepsilon_{\mathrm{MMSE}} &amp;= \mathbb{E}{\tilde{\mathbf{h}}^{\mathrm{H}}\tilde{\mathbf{h}}} = \mathrm{tr}\left{ \mathbb{E}{\tilde{\mathbf{h}}^{\mathrm{H}}\tilde{\mathbf{h}}}\right}= \mathrm{tr}\left{ \mathbb{E}{\tilde{\mathbf{h}}\tilde{\mathbf{h}}^{\mathrm{H}}}\right}\ &amp;= \mathrm{tr}\left{ \mathbb{E}{\mathbf{h}\mathbf{h}^{\mathrm{H}}} - \mathbb{E}{\hat{\mathbf{h}}\hat{\mathbf{h}}^{\mathrm{H}}}\right}\ &amp;= \mathrm{tr}\left{\mathbf{R_{h}} - \mathbf{R_{h}} \mathbf{X}<sup>{\mathrm{H}}\mathbf{R}_{\mathbf{y}}</sup>{-1}\mathbf{R}<em>{\mathbf{y}}\mathbf{R}</em>{\mathbf{y}}^{-1}\mathbf{X}\mathbf{R_{h}}\right}\ &amp;= \mathrm{tr}\left{\mathbf{R_{h}} - \mathbf{R_{h}} \mathbf{X}<sup>{\mathrm{H}}\left(\mathbf{X}\mathbf{R}_{\mathbf{h}}\mathbf{X}</sup>{\mathrm{H}}+\sigma_{z}<sup>{2}\mathbf{I}\right)</sup>{-1}\mathbf{X}\mathbf{R_{h}}\right}\ &amp;= \mathrm{tr}\left{\mathbf{R_{h}} - \mathbf{R_{h}} \left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}+\sigma_{z}</sup>{2}\mathbf{I}\right)<sup>{-1}\mathbf{X}</sup>{\mathrm{H}}\mathbf{X}\mathbf{R_{h}}\right}\ &amp;= \mathrm{tr}\left{\mathbf{R_{h}}\left[\mathbf{I} - \left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}+\sigma_{z}</sup>{2}\mathbf{I}\right)<sup>{-1}\mathbf{X}</sup>{\mathrm{H}}\mathbf{X}\mathbf{R_{h}}\right]\right}\ &amp;= \mathrm{tr}\left{\mathbf{R_{h}}\left[\left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}+\sigma_{z}</sup>{2}\mathbf{I}\right)<sup>{-1}\left(\mathbf{X}</sup>{\mathrm{H}}\mathbf{X}\mathbf{R}<em>{\mathbf{h}}+\sigma</em>{z}^{2}\mathbf{I}\right) - \left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}+\sigma_{z}</sup>{2}\mathbf{I}\right)<sup>{-1}\mathbf{X}</sup>{\mathrm{H}}\mathbf{X}\mathbf{R_{h}}\right]\right}\ &amp;= \sigma_{z}<sup>{2}\mathrm{tr}\left{\mathbf{R_{h}}\left(\mathbf{X}</sup>{\mathrm{H}}\mathbf{X}\mathbf{R}<em>{\mathbf{h}}+\sigma</em>{z}<sup>{2}\mathbf{I}\right)</sup>{-1}\right} \end{align}\</p>
<p>注意到 \varepsilon_{\mathrm{MMSE}} = \mathrm{tr}\left{\mathbf{D}_{\mathbf{h}|\mathbf{y}}\right} ，即估计均方误差为 \mathbf{h} 后验方差的迹。</p>
<p>下比较LS估计和MMSE估计的均方误差性能：</p>
<p>\begin{align} \varepsilon_{\mathrm{LS}} - \varepsilon_{\mathrm{MMSE}} &amp;= \sigma_{z}<sup>{2}\mathrm{tr}\left{(\mathbf{X}</sup>{\mathrm{H}}\mathbf{X})^{-1} - \mathbf{R_{h}}\left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}+\sigma_{z}</sup>{2}\mathbf{I}\right)^{-1}\right}\ &amp;= \sigma_{z}<sup>{2}\mathrm{tr}\left{\left((\mathbf{X}</sup>{\mathrm{H}}\mathbf{X})<sup>{-1}\left(\mathbf{X}</sup>{\mathrm{H}}\mathbf{X}\mathbf{R}<em>{\mathbf{h}}+\sigma</em>{z}^{2}\mathbf{I}\right) - \mathbf{R}<em>{\mathbf{h}}\right)\left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}+\sigma_{z}</sup>{2}\mathbf{I}\right)^{-1}\right}\ &amp;= \sigma</em>{z}<sup>{4}\mathrm{tr}\left{(\mathbf{X}</sup>{\mathrm{H}}\mathbf{X})<sup>{-1}\left(\mathbf{X}</sup>{\mathrm{H}}\mathbf{X}\mathbf{R}<em>{\mathbf{h}}+\sigma</em>{z}<sup>{2}\mathbf{I}\right)</sup>{-1}\right}\ &amp;= \sigma_{z}<sup>{4}\mathrm{tr}\left{\left(\mathbf{X}</sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}+\sigma_{z}</sup>{2}\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\right)</sup>{-1}\right} \end{align}\</p>
<p>从定义不难得到 \mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}\mathbf{X}</sup>{\mathrm{H}}\mathbf{X} 为半正定矩阵， \sigma_{z}<sup>{2}\mathbf{X}</sup>{\mathrm{H}}\mathbf{X} 为正定矩阵，从而可知 \left(\mathbf{X}<sup>{\mathrm{H}}\mathbf{X}\mathbf{R}_{\mathbf{h}}\mathbf{X}</sup>{\mathrm{H}}\mathbf{X}+\sigma_{z}<sup>{2}\mathbf{X}</sup>{\mathrm{H}}\mathbf{X}\right)^{-1} 为正定矩阵，因而有：</p>
<p>\varepsilon_{\mathrm{LS}} - \varepsilon_{\mathrm{MMSE}}&gt;0\</p>
<p>这说明MMSE估计在均方误差意义上优于LS估计，可以直观理解为MMSE信道估计利用了信道的统计信息，故估计性能较优.。</p>
<h2 id="应用场景"><a class="markdownIt-Anchor" href="#应用场景"></a> 应用场景</h2>
<p>以上的推导均基于抽象的信道模型，很容易将其推广到不同的应用场景下，下面以常用的MIMO-OFDM系统为例进行说明。</p>
<p>先考虑单天线发单天线收的情形。设导频OFDM符号第 k 个子载上发送的导频信号为 x_{k} ，信道响应为 H_{k} ，于是接收信号可表示为：</p>
<p>y_{k} = x_{k}H_{k}+z_{k}\</p>
<p>其中 z_{k} 为噪声，服从均值为 0 ，方差为 \sigma_{z}^{2} 的循环对称复高斯分布。令：</p>
<p>\begin{align} \mathbf{y} &amp;= [y_{0} \quad y_{1}\quad \cdots \quad y_{N_{c}-1}]^{\mathrm{T}} \ \mathbf{X} &amp;= \mathrm{diag}{x_{0}, x_{1},\cdots,x_{N_{c}-1}} \ \mathbf{h}<em>{f} &amp;= [H</em>{0} \quad H_{1}\quad \cdots \quad H_{N_{c}-1}]^{\mathrm{T}} \ \mathbf{z} &amp;= [z_{0} \quad z_{1}\quad \cdots \quad z_{N_{c}-1}]^{\mathrm{T}} \end{align}\</p>
<p>则有：</p>
<p>\begin{align} \mathbf{y} = \mathbf{X}\mathbf{h}_{f} + \mathbf{z} \end{align}\</p>
<p>进一步的，在MIMO情形下，假设发送端有 N_{T} 个天线，接收端有 N_{R} 个天线。设 x_{n_{T},k} 为第 n_{T} 个发送天线在第 k 个子载波发送的导频序列， \mathbf{h}<em>{f,n</em>{R},n_{T}} 为第 n_{T} 个发送天线到第 n_{R} 个接收天线之间的频域信道矢量， \mathbf{z}<em>{n</em>{R}} 为噪声矢量，其各元素统计独立，均值为 0 ，方差为 \sigma_{z}^{2} 。设 \mathbf{X}<em>{n</em>{T}} = \mathrm{diag}{x_{n_{T},0}, x_{n_{T},1}, \cdots, x_{n_{T},N_{c}-1}} ,则第 n_{R} 个天线接收到的频域导频信号矢量可以表示为：</p>
<p>\begin{align} \mathbf{y}<em>{n</em>{R}}=\sum_{n_{T}=1}^{N_{T}} \mathbf{X}<em>{n</em>{T}} \mathbf{h}<em>{f, n</em>{R}, n_{T}}+\mathbf{z}<em>{n</em>{R}} \end{align}\</p>
<p>令：</p>
<p>\begin{align} \mathbf{X} &amp;= [\mathbf{X}<em>{1} \quad \mathbf{X}</em>{2}\quad \cdots \quad\mathbf{X}<em>{N</em>{T}}] \ \mathbf{h}<em>{f,n</em>{R}} &amp;= [\mathbf{h}<em>{f,n</em>{R},1}^{\mathrm{T}} \quad \mathbf{h}<em>{f,n</em>{R},2}^{\mathrm{T}} \quad\cdots \quad \mathbf{h}<em>{f,n</em>{R},N_{T}}<sup>{\mathrm{T}}]</sup>{\mathrm{T}} \ \mathbf{h}<em>{f} &amp;= [\mathbf{h}</em>{f,1}^{\mathrm{T}} \quad \mathbf{h}<em>{f,2}^{\mathrm{T}} \quad\cdots\quad \mathbf{h}</em>{f,N_{R}}<sup>{\mathrm{T}}]</sup>{\mathrm{T}} \ \mathbf{y} &amp;= [\mathbf{y}<em>{1}^{\mathrm{T}} \quad \mathbf{y}</em>{2}^{\mathrm{T}} \quad\cdots\quad \mathbf{y}<em>{N</em>{R}}<sup>{\mathrm{T}}]</sup>{\mathrm{T}} \ \mathbf{z} &amp;= [\mathbf{z}<em>{1}^{\mathrm{T}} \quad \mathbf{z}</em>{2}^{\mathrm{T}} \quad\cdots\quad \mathbf{z}<em>{N</em>{R}}<sup>{\mathrm{T}}]</sup>{\mathrm{T}} \end{align}\</p>
<p>则有：</p>
<p>\begin{align} \mathbf{y}=\left(\mathbf{I}<em>{N</em>{R}} \otimes \mathbf{X}\right) \mathbf{h}_{f}+\mathbf{z} \end{align}\</p>
<p>于是，MMSE信道估计结果和相应的均方误差为：</p>
<p>\begin{align} \hat{\mathbf{h}}<em>{f,MMSE} &amp;= \mathbf{R}</em>{h}\left(\left(\mathbf{I}<em>{N</em>{R}} \otimes \mathbf{X}\right)^{\mathrm{H}}\left(\mathbf{I}<em>{N</em>{R}} \otimes \mathbf{X}\right)\mathbf{R}<em>{h}+\sigma</em>{z}<sup>{2}\mathbf{I}\right)</sup>{-1}\left(\mathbf{I}<em>{N</em>{R}} \otimes \mathbf{X}\right)^{\mathrm{H}}\mathbf{y}\ \varepsilon_{MMSE} &amp;= \mathrm{tr}\left(\sigma_{z}^{2}\mathbf{R}<em>{h}\left(\left(\mathbf{I}</em>{N_{R}} \otimes \mathbf{X}\right)^{\mathrm{H}}\left(\mathbf{I}<em>{N</em>{R}} \otimes \mathbf{X}\right)\mathbf{R}<em>{h}+\sigma</em>{z}<sup>{2}\mathbf{I}\right)</sup>{-1}\right) \end{align}\</p>
<blockquote>
<p>[1] A. Hjorungnes and D. Gesbert, “Complex-Valued Matrix Differentiation: Techniques and Key Results,” in IEEE Transactions on Signal Processing, vol. 55, no. 6, pp. 2740-2746, June 2007, doi: 10.1109/TSP.2007.893762.</p>
</blockquote>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/search/">搜索</a></li>
        
          <li><a href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E5%8F%B7%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.</span> <span class="toc-text"> 信号模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98ls%E4%BC%B0%E8%AE%A1"><span class="toc-number">2.</span> <span class="toc-text"> 最小二乘(LS)估计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E5%AF%BC%E6%B3%95"><span class="toc-number">2.1.</span> <span class="toc-text"> 求导法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E6%96%B9%E6%B3%95"><span class="toc-number">2.2.</span> <span class="toc-text"> 配方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%95%E5%BD%B1%E6%B3%95"><span class="toc-number">2.3.</span> <span class="toc-text"> 投影法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6ml%E4%BC%B0%E8%AE%A1%E7%9A%84%E7%AD%89%E4%BB%B7%E6%80%A7"><span class="toc-number">2.4.</span> <span class="toc-text"> 与最大似然（ML）估计的等价性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%B0%E8%AE%A1%E8%AF%AF%E5%B7%AE%E5%88%86%E6%9E%90"><span class="toc-number">2.5.</span> <span class="toc-text"> 估计误差分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E5%9D%87%E6%96%B9%E8%AF%AF%E5%B7%AEmmse%E4%BC%B0%E8%AE%A1"><span class="toc-number">3.</span> <span class="toc-text"> 最小均方误差（MMSE）估计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E5%AF%BC%E6%B3%95-2"><span class="toc-number">3.1.</span> <span class="toc-text"> 求导法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E6%96%B9%E6%B3%95-2"><span class="toc-number">3.2.</span> <span class="toc-text"> 配方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E4%BA%A4%E6%B3%95"><span class="toc-number">3.3.</span> <span class="toc-text"> 正交法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E%E6%9C%80%E5%A4%A7%E5%90%8E%E9%AA%8C%E6%A6%82%E7%8E%87map%E4%BC%B0%E8%AE%A1%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">3.4.</span> <span class="toc-text"> 与最大后验概率（MAP）估计的关系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">4.</span> <span class="toc-text"> 应用场景</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://coisini2133.github.io/posts/7b77.html"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://coisini2133.github.io/posts/7b77.html&text=LS 和 MMSE 估计"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://coisini2133.github.io/posts/7b77.html&title=LS 和 MMSE 估计"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://coisini2133.github.io/posts/7b77.html&is_video=false&description=LS 和 MMSE 估计"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=LS 和 MMSE 估计&body=Check out this article: https://coisini2133.github.io/posts/7b77.html"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://coisini2133.github.io/posts/7b77.html&title=LS 和 MMSE 估计"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://coisini2133.github.io/posts/7b77.html&title=LS 和 MMSE 估计"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://coisini2133.github.io/posts/7b77.html&title=LS 和 MMSE 估计"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://coisini2133.github.io/posts/7b77.html&title=LS 和 MMSE 估计"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://coisini2133.github.io/posts/7b77.html&name=LS 和 MMSE 估计&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://coisini2133.github.io/posts/7b77.html&t=LS 和 MMSE 估计"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024
    Liwen
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     --><!--
       --><li><a href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
